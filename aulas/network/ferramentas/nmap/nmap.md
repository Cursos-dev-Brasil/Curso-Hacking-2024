# Nmap

Quando o assunto é hacking, conhecimento é poder, quanto mais conhecimento sobre um sistema alvo ou rede alvo, mais opções você vai ter. Isso torna imperativo que a enumeração seja realizada antes de qualquer tentativa de exploit

Digamos que tenhamos recebido um IP (ou muitos IPs) para realizar uma auditoria de segurança. Antes de  qualquer coisa, precisamos ter uma ideia da "paisagem" que estamos atacando. Isso significa que você precisa **descobrir quais serviços estão sendo executados** nos alvos. Por exemplo, talvez um deles esteja executando um servidor web, e outro esteja atuando como Controlador de Domínio do Active Directory do Windows. A primeira etapa para estabelecer esse "mapa" da paisagem é algo chamado **escaneamento de portas**. Quando um computador executa um serviço de rede, ele **abre uma construção de rede** chamada de "porta" para **receber a conexão**. Portas são **usadas para fazer várias solicitações de rede ou ter vários serviços disponíveis**. Por exemplo, quando você carrega várias páginas da web ao mesmo tempo em um navegador, o programa precisa ter alguma maneira de determinar qual aba está carregando qual página da web. Isso é feito **estabelecendo conexões com os servidores web remotos** usando diferentes portas em sua máquina local. Da mesma forma, se você deseja que um servidor possa **executar mais de um serviço** (por exemplo, talvez você queira que seu servidor web execute as versões HTTP e HTTPS do site), então você precisa de alguma maneira de **direcionar o tráfego** para o serviço apropriado. Novamente, as portas são a solução para isso. Conexões de rede são **feitas entre duas portas** - **uma porta aberta ouvindo** no servidor e uma **porta selecionada aleatoriamente** em seu próprio computador. Por exemplo, quando você se conecta a uma página da web, **seu computador pode abrir a porta 49534** para **se conectar à porta 443** do servidor.

![Diagrama de como funciona um sistema de portas](/content/diagrama-port.png)<br>
*Imagem removida do site TryHackMe*

O diagrama mostra oque acontece quando você se conecta a vários sites ao mesmo tempo, seu computador abre uma porta aleatória (e de alto número) que é usada para todas as conexões com o serviço remoto

Cada computador tem o **número exato de 65.535 portas disponiveis**, porém muitas delas são **registradas como padrão**. Por exemplo, o **serviço HTTP** roda por **padrão na porta 80** e o **HTTPS** roda por **padrão na 443**, o **NETBIOS do windows** na **porta 139** e o **SMB** na **porta 445**. É importante ter em mente, que **principalmente em um CTF**, não é incomum que **até essas portas padrão sejam alteradas**, como por exemplo um HTTP rodando na porta 64204, HTTPs na 140, NETBIOS na 2000 e SMB na 80

Se não soubermos quais dessas portas um servidor tem abertas, então **não temos esperança de atacar o alvo** com sucesso; portanto, é **crucial** que você **comece qualquer ataque** com um **escaneamento de portas**. Isso **pode ser feito de várias maneiras** - geralmente usando uma ferramenta chamada *nmap* .O nmap pode ser usado para **realizar muitos tipos diferentes de escaneamento de portas**, mas, a teoria básica é: o nmap **se conecta a cada porta do alvo em sequência**. **Dependendo de como a porta responde**, ela pode ser **determinada como aberta, fechada ou filtrada (geralmente por um firewall)**. Depois de saber quais portas estão abertas, podemos então **examinar a enumeração dos serviços** que estão sendo executados em cada porta - seja manualmente ou, mais comumente, usando o nmap.

por que o nmap? A resposta curta é que **ele é atualmente o padrão da indústria** por um motivo: nenhuma outra ferramenta de escaneamento de portas se compara à sua funcionalidade **(embora alguns novatos estejam agora se igualando em velocidade)**. É uma **ferramenta extremamente poderosa** - tornada ainda **mais poderosa por seu mecanismo de script**, que **pode ser usado para procurar por vulnerabilidades** e, em alguns casos, até mesmo **realizar a exploração diretamente**.

    

